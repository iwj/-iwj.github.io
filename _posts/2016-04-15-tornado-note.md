---
layout: post
title: tornado 学习笔记
category: [开发, Python]
---


## 代码片转义

推进项目带劲有趣，却又不得不接受推进缓慢的现实，作为一个初尝者。

问题的大意是：

如何将数据库里取出来的HTML代码块直接渲染出来，而不是在网页里显示`<div>lalala</div>`

今天下午正抓耳挠腮不知道如何表达自己想解决的问题以至于无法正确地搜索。休息了几分钟。再次尝试搜索，不停变换表达，依然无法找到预期的结果。打算关闭几个浏览器标签时，视线来到了pythoner.cn的“介绍tornado”中文翻译站点，一种神秘的预感告诉自己这里会有自己想要的。

果然，看到“自动转义”这一篇章的时候，找到了。此时正好有这样一段心里活动：（斥责自己状）总是带着急切的情绪，导致浮躁，要求自己静下心来看眼前的文字...

果然找到：

你可以禁用自动转义，一种方法是在Application构造函数中传递`autoescape=None`，另一种方法是在每页的基础上修改自动转义行为，如下所示：

~~~python
    { % autoescape None % }

    { { mailLink } }
~~~

这些autoescape块不需要结束标签，并且可以设置xhtml_escape来开启自动转义（默认行为），或None来关闭。

然而，在理想的情况下，你希望保持自动转义开启以便继续防护你的网站。因此，你可以使用`{ % raw % }`指令来输出不转义的内容。

~~~python
    { % raw mailLink % }
~~~

## 趣事

其实，在这之前，我已经考虑过另外一种原因。会不会是因为`str`和`unicode`这方面的原因，因为自己曾多次受他们陷害对这几个兄弟印象特别深，所以这次不例外也在想会不会是这个原因。

于是我在模版里讲`str`类型的变量`decode`了一下，发现依然是原样子。

这都不是重点，而是在于在我刚刚想到这点时，我热泪盈眶，是真的有泪花泛在眼皮！可是，在测试之后发现不是这个原因。
